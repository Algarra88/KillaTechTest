<div class="task-list-container">
  <div class="task-stats">
    <h2>My Tasks</h2>
    <div class="stats">
      <span class="stat">Total: {{ tasks.length }}</span>
      <span class="stat pending">Pending: {{ pendingTasks }}</span>
      <span class="stat completed">Completed: {{ completedTasks }}</span>
    </div>
  </div>

  <div class="error-alert" *ngIf="errorMessage">
    {{ errorMessage }}
  </div>

  <!-- Edit modal -->
  <div class="edit-modal" *ngIf="editingTask">
    <div class="modal-content">
      <app-task-form 
        [taskToEdit]="editingTask"
        (taskSubmit)="onUpdateTask($event)"
        (cancel)="onCancelEdit()">
      </app-task-form>
    </div>
  </div>

  <!-- Delete confirmation modal -->
  <app-confirm-modal
    [isVisible]="deleteConfirmation.isVisible"
    title="Delete Task"
    message="Are you sure you want to delete this task? This action cannot be undone."
    confirmText="Delete"
    cancelText="Cancel"
    [isDangerous]="true"
    (confirmed)="onConfirmDelete()"
    (cancelled)="onCancelDelete()">
  </app-confirm-modal>

  <div class="tasks-grid" *ngIf="tasks.length > 0; else noTasks">
    <div 
      *ngFor="let task of tasks" 
      class="task-card"
      [class.completed]="task.completed"
    >
      <div class="task-header">
        <div class="task-title-row">
          <input 
            type="checkbox" 
            [checked]="task.completed"
            (change)="onToggleComplete(task)"
            class="task-checkbox"
          />
          <h3 [class.strikethrough]="task.completed">{{ task.title }}</h3>
        </div>
        <span class="task-status" [class.completed]="task.completed">
          {{ task.completed ? 'Completed' : 'Pending' }}
        </span>
      </div>

      <p class="task-description">{{ task.description }}</p>

      <div class="task-footer">
        <div class="task-dates">
          <span class="task-date">
            Created: {{ task.createdAt | date:'dd/MM/yyyy HH:mm' }}
          </span>
          <span class="task-date">
            Updated: {{ task.updatedAt | date:'dd/MM/yyyy HH:mm' }}
          </span>
        </div>
        <div class="task-actions">
          <button 
            class="btn btn-edit"
            (click)="onEditTask(task)"
            title="Edit task"
          >
            âœï¸ Edit
          </button>
          <button 
            class="btn btn-delete"
            (click)="onDeleteTask(task.id)"
            title="Delete task"
          >
            ğŸ—‘ï¸ Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <ng-template #noTasks>
    <div class="no-tasks">
      <p>No tasks created yet.</p>
      <p>Create your first task using the form above! ğŸ‘†</p>
    </div>
  </ng-template>
</div>
